### Cr√©ation des User Stories pour la page Metrics
#### Cr√©ation des User Stories pour la page Metrics
##### Prompt
A partir du code et de nos conversation cr√©√© la ou les US pour la mise en place de la page Metric

##### R√©sultat technique
- **Nouveau fichier de Sprint cr√©√©** : `A propos de ce site/2. Sprints/2026-01-21 - Page Metrics - Dashboard de qualit√© du code.md`
- **Sprint Goal d√©fini** : "Mettre en place une page Metrics pour suivre automatiquement la qualit√© du code et l'√©volution du projet √† travers diff√©rentes m√©triques techniques"
- **6 User Stories cr√©√©es** :
  - **US-4.1** : D√©finition des types de m√©triques √† collecter
    - Types d√©finis : TestMetrics, CoverageMetrics, CodeQualityMetrics, CodeSizeMetrics, DependencyMetrics, PerformanceMetrics
    - Structure de snapshot avec timestamp, version, branche, commit
    - Gestion de l'historique avec tendances (up, down, stable)
    - Interface de configuration avec seuils
  - **US-4.2** : Script de collecte automatique des m√©triques
    - Script `scripts/collect-metrics-simple.ts` compatible multi-plateforme
    - Collecte de toutes les m√©triques : tests, couverture, qualit√©, taille, d√©pendances, performance
    - G√©n√©ration de `latest.json` et `history.json` dans `public/metrics/`
    - Calcul automatique des tendances
    - Gestion de l'historique avec limite de 100 snapshots
    - Affichage d'un r√©sum√© console
  - **US-4.3** : Page d'affichage des m√©triques avec dashboard visuel
    - Route `/metrics` avec page Next.js Server Component
    - Header avec version, branche, commit, date
    - 6 sections de m√©triques : Tests (üß™), Couverture (üéØ), Qualit√© (‚ú®), Taille (üìè), D√©pendances (üì¶), Performance (‚ö°)
    - Composants : MetricCard (cartes avec valeur + tendance), ProgressBar (barres de progression color√©es)
    - Layout responsive en grille
    - Design coh√©rent avec le reste du site
  - **US-4.4** : Int√©gration dans le workflow de d√©veloppement
    - Scripts npm : `metrics:collect`, `metrics:view`, `metrics:full`
    - Documentation dans le README
    - Bonnes pratiques pour l'utilisation
  - **US-4.5** : Ajout d'un lien dans la navigation (futur)
    - Lien dans le footer visible uniquement en d√©veloppement
    - Non visible en production (outil pour d√©veloppeurs)
  - **US-4.6** : Graphiques d'√©volution dans le temps (futur)
    - Utilisation de chart.js avec react-chartjs-2
    - Graphiques lin√©aires et en barres pour suivre l'√©volution
    - Filtres par p√©riode (7j, 30j, 90j, tout)
    - Interactions (survol, l√©gende)
- **Structure conforme aux US existantes** : Format "En tant que / Je souhaite / Afin de / Crit√®res d'acceptation" avec th√®mes et crit√®res hi√©rarchis√©s
- **Analyse du code existant** :
  - Page `/metrics` analys√©e : `app/metrics/page.tsx` et `metrics.module.css`
  - Types analys√©s : `types/metrics.ts`
  - Scripts analys√©s : `scripts/collect-metrics.ts` et `scripts/collect-metrics-simple.ts`
  - Package.json analys√© pour identifier les scripts npm disponibles
- **Documentation compl√®te** : Toutes les fonctionnalit√©s existantes et futures sont document√©es avec des crit√®res d'acceptation d√©taill√©s

### Cr√©ation du Sprint 4 - Contr√¥le des MD et JSON
#### Cr√©ation du nouveau Sprint pour valider les fichiers MD et JSON
##### Prompt
Cr√©ons un nouveau Sprint : contr√¥le des MD et JSON

Apr√®s clarifications :
1. Les deux, via des tests d'int√©gration
2. Validation de structure / Validation de contenu via des TI
3. Il y a parfois des bugs au runtime car le contenu des fichiers n'est pas bon
4. Je crois que nous avons d√©j√† quelques tests d'int√©gration pour les MD. Il faudrait contr√¥ler tous les MD du dossier "A propos du site"
Il faut ajouter des TI sur les JSON pour s'assurer que les types contenus dedans sont connus. Si un JSON contient un type que le site ne sait pas g√©rer, il faut soit supprimer l'objet du JSON, soit impl√©menter le type, mais on ne peut pas laisser les choses ainsi.

Le num√©ro du sprint est 4.
L'app peut savoir lire un type qui n'est pr√©sent dans aucun JSON. C'est du code mort mais ce n'est pas un bug. (peut √™tre qu'il est pr√©vu qu'un JSON contienne ce type dans certains contextes).
En revanche on ne veut pas qu'un type trouv√© dans un JSON ne sache pas √™tre converti en HTML par l'APP.

##### R√©sultat technique
- **Nouveau fichier de Sprint cr√©√©** : `A propos de ce site/2. Sprints/2026-01-21 - Sprint 4 - Contr√¥le des MD et JSON.md`
- **Sprint Goal d√©fini** : "Garantir la qualit√© et la coh√©rence des fichiers Markdown et JSON du projet en ajoutant des tests d'int√©gration qui d√©tectent les erreurs de structure et de contenu avant qu'elles ne causent des bugs au runtime"
- **5 User Stories cr√©√©es** :
  - **US-4.1** : Extension des tests d'int√©gration pour tous les fichiers Markdown
    - Validation existante √† maintenir (test `aboutSiteReader.integration.test.ts`)
    - Extension : parsing sans erreur, pas de fichiers vides, encodage UTF-8
    - Gestion d'erreurs explicites (fichier + ligne)
    - Parcours r√©cursif avec exclusion de `node_modules` et `.next`
  - **US-4.2** : Tests d'int√©gration pour valider tous les fichiers JSON du dossier data/
    - Validation de base : parsing JSON, pas de fichiers vides
    - **Validation des types de contenu** : pour chaque type trouv√© dans un JSON, v√©rifier qu'il est connu de l'app
    - Types connus = types g√©r√©s dans le `switch` de `PageContentRenderer.tsx` : 'titre', 'video', 'texteLarge', 'domaineDeCompetence', 'callToAction', 'groupeBoutons', 'temoignages', 'videoDetournement'
    - D√©tection des types inconnus avec message explicite : "Type inconnu '{type}' trouv√© dans {filename} √† l'index {index}. Actions possibles : 1) Supprimer l'objet du JSON, 2) Impl√©menter le type dans PageContentRenderer"
    - Validation des structures imbriqu√©es (champs obligatoires)
    - Rapport de validation avec statistiques (nb de fichiers, nb d'√©l√©ments, types trouv√©s)
    - Nouveau fichier : `tests/integration/jsonValidation.integration.test.ts`
  - **US-4.3** : Correction des fichiers JSON non conformes
    - Identifier les fichiers avec les tests d'US-4.2
    - Corriger chaque erreur (supprimer type inconnu OU impl√©menter le type)
    - Cas sp√©cifique : `portfolio-detournements.json` contient deux cl√©s diff√©rentes ("d√©tournement-original" et "d√©tournements")
    - Validation finale : tous les tests verts
  - **US-4.4** : Int√©gration des tests de validation dans le workflow CI/CD
    - Tests d'int√©gration ex√©cut√©s automatiquement lors de `npm test`
    - Blocage du build si tests √©chouent
    - Rapport d'erreur clair (fichier, erreur, comment corriger)
    - Documentation dans le README (comment ex√©cuter, comment interpr√©ter, comment ajouter un nouveau type)
  - **US-4.5** : Documentation des types de contenu support√©s (futur)
    - Section README avec liste compl√®te des types
    - G√©n√©ration automatique de la doc depuis le code
    - Sch√©mas JSON pour validation automatique
    - Linting JSON en temps r√©el dans VSCode
- **Analyse de l'existant** :
  - Test MD existant : `tests/unit/aboutSiteReader.integration.test.ts` (valide d√©j√† tous les MD)
  - Types accept√©s d√©finis dans `utils/indexReader.ts` (ligne 39)
  - Rendu des types dans `components/PageContentRenderer.tsx` (switch case ligne 32-61)
  - **Probl√®me d√©tect√©** : `portfolio-detournements.json` contient deux cl√©s diff√©rentes
- **Direction du contr√¥le** : JSON ‚Üí App (validation que tous les types dans les JSON sont connus de l'app, pas l'inverse)
- **Code mort autoris√©** : L'app peut g√©rer des types non pr√©sents dans les JSON actuels (pr√©vu pour √©volution future)
- **Bug √† √©viter** : Un JSON qui contient un type inconnu de l'app ‚Üí retourne `null` silencieusement au runtime

### Impl√©mentation de l'US-4.2 - Tests d'int√©gration validation JSON
#### Impl√©mentation des tests d'int√©gration pour valider tous les fichiers JSON
##### Prompt
Impl√©mentation de l'US-4.2 avec approche TDD stricte. D√©l√©gation √† l'agent back-end pour cr√©er les tests d'int√©gration qui valident :
1. Tous les fichiers JSON du dossier data/ peuvent √™tre pars√©s
2. Tous les types de contenu utilis√©s dans les JSON sont connus de l'app
3. Rapport de validation avec statistiques

Validation de l'approche : passer directement √† l'impl√©mentation technique sans sc√©narios BDD formels (crit√®res d'acceptation d√©j√† d√©taill√©s).

Correction du fichier MD "Deux projets parall√®les.md" qui bloquait le build (titre H1 ‚Üí H3).

##### R√©sultat technique
- **Fichier cr√©√©** : `tests/integration/jsonValidation.integration.test.ts`
  - 10 tests d'int√©gration avec progression TDD stricte (8 it√©rations)
  - Validation automatique de tous les fichiers JSON du dossier `data/`
  - D√©tection des types inconnus avec messages d'erreur explicites
  - Validation des structures imbriqu√©es (champs obligatoires)
  - Rapport statistique : nombre de fichiers, d'√©l√©ments, types trouv√©s avec fr√©quence
- **3 bugs d√©tect√©s et corrig√©s** :
  1. `data/portfolio-detournements.json` : 2 virgules manquantes apr√®s accolades fermantes (lignes 154 et 302)
  2. `A propos de ce site/6. Questions et arbitrages/Deux projets parall√®les.md` : Titres H1/H2 convertis en H3/H4/H5
  3. R√©f√©rences incorrectes : "D√©tournements vid√©o.json" renomm√© en "D√©tournement vid√©o.json" (5 fichiers affect√©s)
- **Validation automatique r√©ussie** :
  - 10 fichiers JSON valid√©s
  - 44 √©l√©ments de contenu analys√©s
  - 7 types diff√©rents d√©tect√©s et valid√©s : titre (10), texteLarge (8), video (3), domaineDeCompetence (13), callToAction (6), groupeBoutons (2), videoDetournement (2)
- **Progression TDD document√©e** :
  - IT√âRATION 1 : Lecture des fichiers JSON
  - IT√âRATION 2 : Parsing JSON sans erreur
  - IT√âRATION 3 : V√©rification fichiers non vides
  - IT√âRATION 4 : Extraction des types de contenu
  - IT√âRATION 5 : Validation des types connus
  - IT√âRATION 6 : D√©tection des types inconnus
  - IT√âRATION 7 : Validation des structures imbriqu√©es
  - IT√âRATION 8 : Rapport de validation avec statistiques
- **Qualit√©** :
  - Tests : 10/10 PASS
  - Build : SUCCESS
  - Linters : PASS (aucune erreur)
  - Couverture : 100% (statements, branches, functions, lines)
- **Git** : Commit et push r√©ussis
- **D√©ploiement** : Vercel d√©ploie automatiquement
- **US-4.2** : ‚úÖ **TERMIN√âE √† 100%**
