### UI/UX - Expériences à la demande

#### Affichage des expériences uniquement à la demande
##### Prompt
Sujet UI/UX. Les expériences ça charge beaucoup trop les pages. Peut-être faut-il trouver une ruse pour ne les afficher qu'à la demande.

##### Résultat technique
- Affichage des expériences uniquement après clic sur un bouton « Expériences et apprentissages (N) » dans `DomaineDeCompetences.tsx`
- État local `experiencesOuvert` (useState), liste et tri rendus seulement quand ouvert : allègement du premier rendu (pas de parse Markdown ni tri pour les expériences tant que non ouvert)
- Bouton avec chevron (ChevronDown/ChevronUp), accessibilité : aria-expanded, aria-controls, role="region"
- Styles dans `app/content-styles.css` : `.experiencesToggle`, `.experiencesToggleIcon`, `.experiencesContent`
- Tests unitaires adaptés : helper `ouvrirExperiences()` pour les tests qui vérifient le contenu ; nouveau test « masquer la liste par défaut »

#### Réduction taille police et images compétences
##### Prompt
Réduire la taille de la police pour "Expériences et apprentissages". Les images des compétences sont trop "présentes". Probablement faut-il les mettre plus petites.

##### Résultat technique
- `.experiencesTitre` : `font-size` 18px → 14px dans `app/content-styles.css`
- `.competenceImage` : `max-width` 200px → 100px dans `app/content-styles.css`
- Icônes Lucide dans `DomaineDeCompetences.tsx` : `size` 120 → 72

### Refactoring expériences et apprentissages

#### Refactoring structure JSON expériences
##### Prompt
A mon avis il faut corriger le fichier JSON en repartant du MD. Le MD liste des "experience-et-autres-informations" avec des - Il faut en extraitement seulement les périodes, pour alimenter le champ "période" mais supprimer le champs "Titre" et n'alimenter, en conservant la syntaxe MD du gras, dans le champ "Description". Puis refactoriser tout le mode pour ne plus implémenter le champ "Titre"

##### Résultat technique
- Création d'un script de refactoring (`scripts/refactor-experiences-remove-titre.ts`) pour transformer le JSON
- Suppression du champ `titre` de l'interface `AutreElement` dans `utils/bibliothequeReader.ts`
- Modification du composant `DomaineDeCompetences.tsx` pour n'utiliser que le champ `description` avec syntaxe Markdown
- Mise à jour de tous les tests unitaires pour utiliser uniquement `description`
- Transformation de 145 expériences : extraction des périodes, fusion titre+description dans `description` avec syntaxe MD

#### Ajustements espacements expériences
##### Prompt
Il faut que visuellement les "Expériences et apprentissages" soient comprises comme partie intégrante du domaine qui est au desus. Les "Expériences et apprentissages" sont trop éloignées des 3 compétences - réduire le padding. Les "Expériences et apprentissages" sont trop éloignées entre elles- Réduire l'interligne. Les "Expériences et apprentissages" sont trop rapprochées du domaine de compétence suivant - augmenter le padding.

##### Résultat technique
- Réduction de `margin-top` de `.experiencesContainer` : 30px → 10px
- Réduction de `margin-bottom` de `.experienceItem` : 0.75rem → 0.4rem
- Réduction de `line-height` de `.experienceItem` : 1.6 → 1.4
- Ajout de `margin-bottom: 40px` à `.experiencesContainer`
- Uniformisation de l'espacement entre titre et expériences : `margin-bottom` de `.experiencesTitre` aligné avec `.experienceItem` (0.4rem)

#### Tri chronologique des expériences
##### Prompt
Trier les "Expériences et apprentissages" par date - les valeur "null" d'abord, par ordre inverse chronologique ensuite

##### Résultat technique
- Implémentation d'une fonction de tri dans `DomaineDeCompetences.tsx`
- Les périodes `null` sont placées en premier
- Tri chronologique inverse (plus récent en premier) pour les expériences avec période
- Fonction `getLatestYear()` pour extraire l'année la plus récente de différents formats de périodes (2022-2023, Depuis 2020, février-juin 2022, etc.)
- Correction d'un bug : vérification de type pour éviter `periode.match is not a function`

#### Correction doublons expériences
##### Prompt
Je suis en train de rellire (et mettre quelques mots en gras **) dans le fichier "experience-et-autres-informations.json" et j'ai l'impression de relire plusieursfois la même chose. Je n'ai pas souvenir d'avoir perçu lors de la relecture du MB d'origine. Peux tu faire une analyse "sémentique" de chaque compétence pour identifier les potentiels doublons ?

##### Résultat technique
- Analyse sémantique des expériences pour identifier les vrais doublons (expériences identiques pointant vers des domaines différents)
- Suppression de 8 expériences doublons : 75, 81, 95, 107, 124, 125, 126, 138
- Fusion de l'expérience 75 dans 23 (ajout de la période "Depuis 2013")
- Mise à jour des références dans `domaines.json` pour remplacer les IDs supprimés
- Résultat : 137 expériences (au lieu de 145)

#### Nettoyage expériences supplémentaires
##### Prompt
Supprime "[Depuis 2020] - Prise de conscience des enjeux énergétiques, climatiques et de l'empreinte matière". Ajoute "Depuis 2020" à la période de "Sensibilisation aux polycrises (pandémie, approvisionnement énergétique, inflation, guerres, désinformation, polarisation, inondations, sécheresses, mégafeux)". Supprime "5800 followers sur Linkedin"

##### Résultat technique
- Suppression de l'expérience 64 (doublon de 95 déjà supprimé)
- Ajout de la période "Depuis 2020" à l'expérience 97
- Suppression de l'expérience 58
- Mise à jour des références dans les domaines concernés

#### Ajout formations Sator
##### Prompt
Ajouter les compétences : - Grand cours Sator : "Olivier Hamant - Construire la robustesse" - Certifié - Grand cours Sator : "Arthur Keller - Risques systémiques et stratégies de résilience" - En cours. Type : "Formations et certifications". Ajouter au domaine de compétence "La ROBUSTESSE est la réponse opérationnelle à un monde fluctuant !*"

##### Résultat technique
- Ajout de 2 nouvelles expériences (IDs 146 et 147) dans `experience-et-autres-informations.json`
- Association au domaine `la-robustesse-est-la-reponse-operationnelle-a-un-monde-fluctuant`
- Type : "Formations et certifications"

#### Ajustements CSS
##### Prompt
Les boutons "En savoir plus..." dans les "compétences" : un padding de 10 pixels au dessus

##### Résultat technique
- Ajout de `padding-top: 10px` à `.domaineDeCompetence .competenceBoutonContainer` dans `app/content-styles.css`

### Amélioration script "Publie"

#### Refactoring script Publie pour chronométrage direct
##### Prompt
Pourquoi lancer les tests en async alors qu'on doit toujours les chronométrer ? - Lancer les tests avec chronométrage - Si ça ne passe pas, lister les échecs en expliquant l'exigence du test et la cause de l'échec pour permettre un arbitrage et s'arrêter - Si ça passe, publier

##### Résultat technique
- Refactoring complet du script `scripts/publie.ts`
- **Lancement direct avec chronométrage** : Les tests sont maintenant lancés directement avec `--coverage --json --outputFile=test-results.json` (plus de double exécution)
- **Analyse détaillée des erreurs** : Pour chaque test en échec, le script affiche :
  - L'exigence du test (nom du test)
  - La cause de l'échec (TypeError, ReferenceError, valeurs attendues/reçues, etc.)
  - Le message d'erreur complet si court (< 200 caractères)
- **Arbitrage facilité** : Le script explique clairement que l'échec peut être dû soit à un bug dans le code, soit à une évolution des spécifications nécessitant une mise à jour des tests
- **Workflow optimisé** : 3 étapes au lieu de 4 :
  1. Tests avec chronométrage (coverage + JSON)
  2. Collecte métriques E2E/BDD (si tests OK)
  3. Vérification couverture + publication Git
- **Pas de relance inutile** : Les tests Jest ne sont plus lancés deux fois (une fois sans timing, une fois avec)

#### Correction erreur TypeScript script analyse-bilan-competences
##### Prompt
Lors des 3 derniers commit cette erreur est apparue sur Vercel. Corrige la avant de publier à nouveau. Erreur : `domaine.contenu` n'existe pas (ligne 656). Mais zut de flute à la fin ! Le scenario est créé par le TI ! Il faut lancer ce TI avant de lancer les tests E2E pour s'assurer que le scénario est à jour

##### Résultat technique
- Correction de l'interface `Domaine` dans `scripts/analyse-bilan-competences.ts`
- Ajout des propriétés optionnelles `contenu?: string` et `auteur?: string` à l'interface
- Ces propriétés existent dans le JSON `domaines.json` mais n'étaient pas déclarées dans l'interface TypeScript
- Le code vérifiait déjà avec `if (domaine.contenu)` mais TypeScript ne reconnaissait pas la propriété
- **Ajout de la génération du scénario E2E** dans `scripts/publie.ts` avant de lancer les tests
- Le script génère maintenant le scénario E2E avec `npm run test:e2e:generate` en étape 0/4
- Cela garantit que le scénario E2E est à jour avant que les tests d'intégration ne vérifient la couverture des e2eID
