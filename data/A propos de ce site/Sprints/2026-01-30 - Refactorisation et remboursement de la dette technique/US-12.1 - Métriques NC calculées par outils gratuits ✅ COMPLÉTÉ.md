# US-12.1 : Métriques « NC » calculées par outils gratuits ✅ COMPLÉTÉ

- **En tant que** développeur ou Lead Dev qui consulte la page Metrics
- **Je souhaite** que les métriques actuellement affichées comme « NC » (non calculées) soient calculées par des outils gratuits lorsque c’est possible, et que leurs valeurs soient enregistrées dans le snapshot puis dans history.json
- **Afin de** disposer d’un tableau de bord Metrics fiable et complet, sans valeur inventée ou placeholder pour les métriques pour lesquelles un outil gratuit existe

- **Critères d'acceptation** :

- **CA1 - Type Coverage** :
  - La métrique « Type Coverage » (qualité du code) est calculée par l’outil type-coverage (déjà en dépendance ou ajouté).
  - La valeur (pourcentage entier) est enregistrée dans le snapshot sous `quality.typeCoverage` et donc présente dans `public/metrics/latest.json` et dans `public/metrics/history.json`.
  - En cas d’échec du calcul (projet non compilable, etc.), la valeur reste « NC ».

- **CA2 - Score Lighthouse** :
  - Lorsqu’une URL cible est fournie (variable d’environnement, ex. `METRICS_LIGHTHOUSE_URL`), le script de collecte exécute Lighthouse sur cette URL et récupère le score de performance (0–100).
  - La valeur est enregistrée dans le snapshot sous `performance.lighthouseScore` et donc dans latest.json et history.json.
  - Si l’URL n’est pas définie ou si Lighthouse échoue (Chrome absent, URL injoignable), la valeur reste « NC ».

- **CA3 - Outils et script** :
  - Les outils gratuits nécessaires (type-coverage, lighthouse) sont disponibles en devDependency et utilisés par le script de collecte (`scripts/collect-metrics-simple.ts` ou équivalent).
  - Aucune valeur inventée (placeholder fixe) n’est écrite pour Type Coverage ni pour le score Lighthouse lorsque le calcul a réussi.

- **CA4 - Métriques restantes** :
  - Les métriques pour lesquelles aucun outil gratuit simple n’est intégré (complexité cyclomatique, index de maintenabilité, dette technique) restent à « NC » dans le snapshot, avec possibilité d’évolution ultérieure sans bloquer cette US.
