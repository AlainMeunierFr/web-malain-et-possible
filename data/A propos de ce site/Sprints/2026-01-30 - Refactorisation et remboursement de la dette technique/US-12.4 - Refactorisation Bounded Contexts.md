# US-12.4 - Refactorisation Bounded Contexts

## En tant que
Développeur / Architecte

## Je souhaite
Réorganiser le code métier (`utils/`) et les API Routes (`app/api/`) par Bounded Contexts

## Afin de
- Respecter les principes DDD (Domain-Driven Design)
- Séparer clairement les responsabilités entre domaines
- Préparer l'exposition Swagger du domaine Vitrine
- Faciliter la maintenance et l'évolution du code

## Critères d'acceptation

### 3 Bounded Contexts identifiés

1. **Vitrine** : Site public (lecture seule)
   - Pages, profils, compétences, domaines, expériences
   - Navigation, menu, plan du site (lecture)
   - SEO (JSON-LD, metadata)
   - Témoignages, détournements vidéo

2. **Projet** : Méta-documentation (lecture seule)
   - Documentation "À propos du site"
   - Sprint board, User Stories
   - Journaux
   - Métriques
   - Hiérarchie du site (illustration)

3. **BackOffice** : Administration (Commands + Queries)
   - Plan du site (source de vérité, génération)
   - Hiérarchie (génération)
   - Scénarios E2E (génération)
   - Intégrité référentielle
   - Authentification
   - *Futur : CQRS:ES pour édition JSON*

### Structure cible `utils/`

```
utils/
├── vitrine/           # Domaine "Site Vitrine"
├── projet/            # Domaine "Le Projet"
├── backoffice/        # Domaine "Back-Office"
│   ├── commands/
│   ├── generators/
│   └── integrity/
└── shared/            # Transversal
    └── markdown/
```

### Structure cible `app/api/`

```
app/api/
├── vitrine/           # API publiques (Swagger)
├── projet/            # API projet (Node.js)
├── backoffice/        # API admin (Node.js)
│   ├── commands/
│   ├── queries/
│   └── auth/
└── health/
```

### Pattern Published Language

Le BackOffice est source de vérité pour :
- Plan du site → consommé par Vitrine et Projet
- Hiérarchie → consommée par Projet

### Migrations

| Fichier actuel | Destination |
|----------------|-------------|
| `indexReader.ts` | `vitrine/pageReader.ts` |
| `bibliothequeReader.ts` | `vitrine/` |
| `profilBuilder.ts` | `vitrine/` |
| `journalReader.ts` | `projet/` |
| `sprintBoardReader.ts` | `projet/` |
| `siteMapGenerator.ts` | `backoffice/generators/` |
| `siteHierarchyGenerator.ts` | `backoffice/generators/` |
| `markdownParser.ts` | `shared/markdown/` |
| ... | ... |

## Notes techniques

- Mise à jour de tous les imports
- Tests existants doivent continuer à passer
- Pas de changement fonctionnel, uniquement structurel
