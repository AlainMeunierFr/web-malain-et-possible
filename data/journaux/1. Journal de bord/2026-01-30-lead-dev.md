### US affichage par défaut « Sprint en cours » et bouton bleu foncé sur le board

#### GO US – affichage par défaut et bouton « Sprint en cours » bleu foncé
##### Prompt
GO US
Lorsqu'on arrive sur la page "A propos de ce site", l'affichage par défaut est "Sprint en cours"
Le bouton "Sprint en cours" doit rester bleu foncé tant qu'on est sur le board.

##### Résultat technique
- **Affichage par défaut** : Déjà en place : la page racine `/a-propos-du-site` utilise `SprintDashboardLayout` qui affiche la bande horizontale, le Sprint Goal et la zone Sprint (board). Aucune modification nécessaire.
- **Bouton « Sprint en cours » bleu foncé** : Dans **SprintDashboardLayout.tsx** (client), utilisation de `usePathname()` (next/navigation) ; variable `estSurBoard = pathname === '/a-propos-du-site'`. Pour les lignes de type container (ex. « Sprint en cours »), le lien reçoit `className={estSurBoard ? styles.bandeDossiersLinkActive : styles.bandeDossiersLink}`. Ainsi le bouton reste en style actif (bleu foncé) tant que l’utilisateur est sur le board.

### Reconfiguration des agents – 2 commandes GO US et GO NEXT

#### Implémentation workflow dans les fichiers de config
##### Prompt
Implémente ça dans les fichiers de config (workflow : GO US, GO NEXT ; si agent ≠ lead-dev → lead-dev prend la main ; si lead-dev : revue → pause → au GO NEXT suivant corrections / agent suivant / clôture US).

##### Résultat technique
- **lead-dev-principal.mdc** : Section « Commandes » remplacée par **2 commandes** (GO US, GO NEXT). GO NEXT : si agent courant ≠ Lead Dev → Lead Dev prend la main ; si Lead Dev : (1) vient de recevoir la main → revue, rapport, pause ; (2) au GO NEXT suivant → erreurs → Task vers agent, OK et étape suivante → invoker agent suivant, OK et pas d'étape suivante → étape = `done`. Clôture US = cas de GO NEXT (plus de commande US VALIDÉE). Build/tests : au moment de la clôture.
- **5 . Review.md** (Lead Dev) : **2 commandes** (GO US, GO NEXT) avec arbre complet (revue → pause ; au GO NEXT suivant : corrections / agent suivant / clôture). Section « Tu fais » alignée.
- **1. US.md**, **2. BDD.md**, **3. TDD-back-end.md**, **4. TDD-front-end.md** : GO NEXT = Lead Dev traite ; en fin de livraison indiquer *Merci de dire **GO NEXT** pour que le Lead Dev fasse la revue.*
- **US en cours.md** : Ligne « Commandes » mise à jour (GO US, GO NEXT ; clôture = GO NEXT après revue OK).

### Renumérotaion US dernier sprint : US-1.x → US-11.x

#### Correction préfixe numéro de sprint
##### Prompt
Nous avons avant un petit problème technique à régler. Le dernier sprint a ses US qui sont préfixées "US-1." Or c'est le 11e Sprint. Je pourrais renommer les fichiers mais il faut aussi renommer dans le code. Je te laisse donc faire "US-1." -> "US-11."

##### Résultat technique
- **Sprint 2026-01-28** : Fichiers US renommés US-1.1 → US-11.1 … US-1.7 → US-11.7 ; `Revue Lead Dev - US-1.5 front-end.md` → `Revue Lead Dev - US-11.5 front-end.md`. Fichier `00 - Sprint goal et contexte.md` mis à jour (liste US-11.1 à US-11.7). Anciens fichiers US-1.x supprimés.
- **Code et tests** : Références US-1.x → US-11.x dans app/, components/, utils/, tests/bdd/, tests/unit/, .cursor/agents, .cursor/US-EN-COURS.md, data/A propos de ce site/Sprints/US en cours.md. **Non modifié** : dossier `2025-01-17 - Site Web - Structure de Base` (US-1.1, US-1.2, US-1.3, US-1.4a, US-1.4b = 1er sprint) ; tests utilisant ces numéros comme exemples de format (user-stories-format, criteresAcceptationParser, userStoryParser) ; Header.test (US-1.2, US-1.4a, US-1.4b = 1er sprint) ; journaux (historique conservé).

### Nouveau Sprint – Refonte de la page metrics

#### Création du sprint
##### Prompt
Nouveau Sprint : Refonte de la page metrics

##### Résultat technique
- **Dossier créé** : `data/A propos de ce site/Sprints/2026-01-30 - Refonte de la page metrics/`.
- **00 - Sprint goal et contexte.md** : Sprint goal = refondre la page Metrics (UX, lisibilité, alignement besoins) ; contexte = la page existe déjà (Sprint 2026-01-21), ce sprint vise la refonte (structure, présentation, contenu, sources). Liste des US laissée vide pour ajout au fil du sprint.

### US-12.1 – Métriques NC calculées par outils gratuits (history.json)

#### GO NEXT – Revue livraison US (formalisation US-12.1)
##### Prompt
GO NEXT
##### Résultat technique
- **Revue Lead Dev** : Étape courante = US. Livrable = US-12.1 + CA (fichier `US-12.1 - Métriques NC calculées par outils gratuits et enregistrées dans history.md` dans sprint 2026-01-30). Conformité format DOD : titre H4 (#### US-12.1), En tant que / Je souhaite / Afin de, Critères d'acceptation avec CA1–CA4 testables et sans ambiguïté. Vérification croisée avec le code existant (implémentation réalisée avant formalisation de l’US) : CA1 Type Coverage (collectTypeCoverage, quality.typeCoverage) ✓ ; CA2 Lighthouse (METRICS_LIGHTHOUSE_URL, performance.lighthouseScore) ✓ ; CA3 type-coverage et lighthouse en devDependencies, script collect-metrics-simple.ts ✓ ; CA4 métriques restantes à « NC » ✓. Rapport : **OK**, passage à l’étape BDD possible au prochain GO NEXT.

#### Livraison TDD-front-end – Step definitions page-metrics-valeurs-correctes (US-12.1)
##### Prompt
US en cours : US-12.1 — Métriques NC calculées par outils gratuits et enregistrées dans history. Étape : TDD-front-end. Livrable attendu : step definitions pour la feature BDD page-metrics-valeurs-correctes.feature, et vérification que l'affichage de la page Metrics respecte les scénarios.
##### Résultat technique
- **Fichier créé** : `tests/bdd/page-metrics-valeurs-correctes.steps.ts` avec tous les steps (Given/When/Then) pour les 5 scénarios : Type Coverage affiché/absent, Score Lighthouse affiché/absent, métriques NC (Complexité cyclomatique, Index de maintenabilité, Dette technique) absentes. Given : préparation du snapshot via `buildMetricsSnapshot` / `buildMetricsHistory` et écriture dans `public/metrics/history.json`. When : `page.goto(path)`. Then : vérification visibilité des cartes dans les sections « Qualité du code » et « Performance », et valeur (pourcentage / 0–100) via ancêtre du titre (xpath=../..) et `[class*="cardValue"]`. Paramètres Gherkin : {string}, {int}, parenthèses échappées \\( \\) pour Cucumber.
- **Config dédiée** : `playwright.config.metrics-only.ts` (feature + steps limités à page-metrics, outputDir `tests/bdd-generated`, testDir idem pour résolution BDD config au runtime). Génération : `npx bddgen test -c playwright.config.metrics-only.ts` ; exécution : `npx playwright test -c playwright.config.metrics-only.ts --project=chromium`.
- **Config principale** : `testMatch` complété par `tests/bdd-generated/**/*.spec.js` ; `.gitignore` complété par `tests/bdd-generated/`.
- **Feature** : tag `@page-metrics-valeurs-correctes` ajouté pour filtrage.
- **Vérification** : 5 scénarios exécutés et passés (chromium). Aucune modification de `app/metrics/page.tsx` (comportement déjà conforme).

#### GO NEXT – Revue livraison TDD-front-end (US-12.1)
##### Prompt
GO NEXT
##### Résultat technique
- **Revue Lead Dev** : Étape courante = TDD-front-end. Livrable = step definitions `page-metrics-valeurs-correctes.steps.ts`, config `playwright.config.metrics-only.ts`, feature tag @page-metrics-valeurs-correctes, testMatch et .gitignore pour bdd-generated. Vérifications : feature et steps alignés avec US-12.1 et CA (Type Coverage / Score Lighthouse affichés ou absents selon valeur ou NC, métriques NC sans valeur inventée) ; `buildMetricsSnapshot` / `buildMetricsHistory` utilisés correctement ; linters OK sur le fichier steps ; génération bddgen et exécution Playwright (config metrics-only) : 5 scénarios passés (chromium). Pas de nouvelle page ni nouveau lien → pas de vérification plan du site / e2eID. Rapport : **OK**, livraison conforme. Pas d’agent suivant (étape TDD-front-end) → au prochain GO NEXT : clôture US (étape = `done`).

#### GO NEXT – Clôture US-12.1 (étape = done)
##### Prompt
GO NEXT
##### Résultat technique
- **Clôture** : Étape passée à `done` dans `data/A propos de ce site/Sprints/US en cours.md` et `.cursor/US-EN-COURS.md` (US-12.1 – Métriques NC calculées par outils gratuits et enregistrées dans history).
- **Build** : `npm run build` exécuté avec succès (Next.js 16, 19 pages, ~16 s). Avertissement : script `update-site-map.ts` en erreur (module `utils/siteMapGenerator` non résolu par ts-node en mode ESM) ; le build a continué.
- **Suite de tests** : `npm run metrics:collect` lancé ; échecs **préexistants** (non liés à US-12.1) : tests unitaires `e2eScenarioBuilder.test.ts` (assertions sur chaînes générées : `page.goto('/')` vs `page.goto('/', { waitUntil: 'domcontentloaded' })`, `toHaveURL('/plan-du-site')` vs `toHaveURL(..., { timeout })`), tests d’intégration `aboutSiteReader.integration.test.ts` (validation H1/H2 dans un fichier MD), `siteMapGenerator.integration.test.ts` (liens /faisons-connaissance, /temoignage-linkedin, nombre de liens). À traiter dans une US dédiée ou une correction ciblée.
- **US-12.1** : considérée **terminée** (étape = `done`). Aucune US en cours jusqu’au prochain **GO US**.
- **Git** : commit « Clôture US-12.1 - Métriques NC (étape done, journal) », push sur `main`.

### Dashboard KanBan – colonnes vides en local, 2 colonnes sur Vercel

#### Correction affichage board : étape done → Fait, fallback colonnes agents
##### Prompt
Dashboard KanBan
- En local : 7 colonnes mais toutes vides ; nombreuses US COMPLETEE ; colonne "Fait" devrait contenir 1 US.
- Sur Vercel : seulement "A Faire" et "Fait" ; "Fait" vide alors qu'elle devrait contenir 1 US.

##### Résultat technique
- **Cause locale** : L’US en cours (US-12.1) a étape = `done` mais le fichier US n’a pas « ✅ COMPLÉTÉ » dans le nom. Le reader mettait la carte en `en_cours` avec `agentColumn = 'done'` ; aucune colonne n’ayant l’id `done`, la carte n’apparaissait dans aucune colonne.
- **Cause Vercel** : Si `.cursor/agents` est absent ou vide au runtime, `readAgentsFromCursorAgents()` renvoyait [] et le board n’affichait que A faire + Fait (aucune colonne agent).
- **utils/sprintBoardReader.ts** : (1) Quand l’US en cours a étape `done`, la carte correspondante est maintenant considérée en état `fait` (affichée dans la colonne Fait), même sans « ✅ COMPLÉTÉ » dans le nom du fichier. (2) Constante `DEFAULT_AGENTS` (US, BDD, TDD-back-end, TDD-front-end, Review) ; si `readAgentsFromCursorAgents()` renvoie [], utilisation de ces colonnes par défaut dans `getSprintBoardData()`.
- **tests/unit/sprintBoardReader.test.ts** : test « retourne la carte en état fait quand l’US en cours a étape "done" (sans ✅ dans le nom) » ; test « utilise les colonnes agents par défaut quand .cursor/agents est vide » (7 colonnes, Fait count 1). 23 tests passent.

#### Consignes Lead Dev + suppression valeurs par défaut agents
##### Prompt
1. Consignes Lead Dev : à la clôture (GO NEXT après revue OK TDD-front-end → étape = done), lancer suite de tests et build ; pour le fichier MD de l’US en cours, ajouter "✅ COMPLÉTÉ" à la fin du nom du fichier et à la fin de la première ligne du fichier. 2. Ne pas fournir de valeurs par défaut pour les agents ; les agents évoluent ; .cursor/agents est désormais poussé sur GitHub (.gitignore modifié) ; faire pareil entre GitHub et Vercel.
##### Résultat technique
- **.cursor/rules/lead-dev-principal.mdc** : section « Build et suite de tests — quand les lancer » complétée : à la clôture, ajouter « ✅ COMPLÉTÉ » à la fin du **nom du fichier** MD de l’US et à la fin de la **première ligne** du fichier. (L’agent 5 . Review.md contenait déjà cette consigne.)
- **utils/sprintBoardReader.ts** : suppression de la constante `DEFAULT_AGENTS` et du fallback « si agents vide alors utiliser DEFAULT_AGENTS ». Les colonnes du board sont uniquement dérivées de `.cursor/agents` ; si le dossier est vide (ou absent), le board n’a que les colonnes « A faire » et « Fait ». Sur Vercel, les fichiers `.cursor/agents` doivent être présents dans le dépôt (déjà poussés sur GitHub) pour que le déploiement les inclue (Vercel clone le repo).
- **tests/unit/sprintBoardReader.test.ts** : test « utilise les colonnes agents par défaut » remplacé par « retourne seulement A faire et Fait quand .cursor/agents est vide » (2 colonnes, Fait count 1). 23 tests passent.
